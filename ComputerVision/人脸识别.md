# 人脸识别：人脑认知与计算机算法

现阶段，人脸识别是人工智能领域最炙手可热的话题之一。Google和Facebook，以及国内一些创业公司都投入重金在该领域进行研发，并且有相当多的商业应用。随着Deep Learning算法的引入，计算机在人脸识别方面的准确率和鲁棒性得到了一个突破性的提高 [1, 2], 计算机算法犯第二类错误（把假当作真，即把非A识别为A）的概率也下降了很多，相比于识别失败率，这个参数在工业场景的应用中可能更为重要，因为他会更直接关系到产品的安全性。计算机人脸识别系统在安全方面的应用因此有了更好的接受度。

计算机人脸识别的准确率已经超过人类。目前的算法体现出来一些特征，从人脑的人脸认知和识别角度来看，显得非常的有趣。计算机人脸识别算法面对自然场景的人脸识别（Face Recognition in the Wild）问题时仍然有一些困难[3]，而这些困难又跟人脑在自然场景做人脸识别时面对的困难又有一些相似和不同。这些问题的根本原因，还是在于计算机与人脑在人脸识别任务上处理的方法，或者说算法原理方面的相似性和不同。

大略来看，在人脸方面我们可以问以下一类问题：

1. 人在做人脸识别时候的注意点 跟 计算机算法（特别地，深度神经网络）的“认知”重点有什么差异
2. 人在做人脸识别的学习过程中，需要的样本数量很多，但是跟深度神经网络训练所需的动则上百万个样本这样一个数量级还是有很大的差距 [4]，是什么导致了这个问题
3. 人脑人脸识别任务的一些低识别率场景是怎么导致的；计算机算法也会面对类似的问题，其原因是什么；两种算法（人脑的识别算法/模型 与 计算机的算法）如何相互参考
4. 计算机人脸识别算法最新趋势中跟人脑认知的差异
5. .......



在做人脸识别训练方面，人脑认知与计算机算法的第一个不同在于，人类接受的**人脸图像训练是多角度的、动态的**，而目前**计算机算法在训练之中使用的基本上是静态的图片**[1]。现有的图像训练数据库，无论是常用的一类公开数据集LFW, CASIA-WebFace, 还是Google和Facebook使用的闭源数据库，即便对同一个人有很多张不同时间和场景的图片，他们都只是截取了有限的角度。

<Fig. 典型人脸数据集图片>

人类在要认识一个陌生人时，不免需要多观察几眼，特别是对于一个长的美貌/化妆过的人脸，由于更接近平均人脸，外在特征(external features: hair, face, outline)和内在特征(internal features: eyes, nose, mouth) [2] 相对来说不明显，一般需要动态观察更久才能记住。

实验室条件下的受限环境刺激和训练证明，人类识别/记住一个陌生人脸，使用动态图像比使用静态图片更有优势 [3, 4]:

![img](https://pic3.zhimg.com/6b973a77d85d33f76c130bc0899e62b6_b.png)<Fig. 静态人脸v.s动态人脸>

<Fig. 静态人脸v.s动态人脸任务的反应时间，反应时间越短越好>

不难想象的，动态人脸能提供来自更多角度的更多可供识别的信息，即使实验场景下，这些动态人脸提供的信息跟真实场景中的还有一定的差距，但是动态人脸刺激相比于静态人类刺激的优势在实验场景下可观测的。

在计算机算法方面，近年来随着深度学习的引入，主流人脸识别算法对训练图像的数量提出了越来越高的需求，动则达到数百万以上，Google 的FaceNet更是达到令人嗔目结舌的20亿数量级[5, 6]，但是不开放。传统学术界的实验室算法受限于使用公开数据集，为了达到更好的效果不得不另辟蹊径，在有限的图像上获取更多信息，也就是Data Augmentation [7]. 最简单的Face Data Augmentation无疑是变换图像的左右，但是这种做法有可能已经改变了人脸的内在特征。需要权衡带来的好处（图像数量增加）与缺陷（部分特征可能被抵消）。另一类算法通过模拟人脸在其他视角的图像做Face Data Augmentation. 最初来源于人脸摆正(face frontalization)[8]。

![img](https://pic4.zhimg.com/917605ee17c2263df65f2903f4ea1de7_b.png)<Fig. [8]中人脸摆正算法流程>

[8] 中算法通过Face Landmark Detector处理目标图像和三维模型图像（二维化之后），得到一组对应的Landmark. 而二维化之后的三维模型上的Landmark（{Xi, Yi}）在三维模型中具有对应的坐标({Xi, Yi, Zi}). 据此可以估测相机参数，进行相机标定 [9]。从而可以模拟模型与目标图像一样的角度，反过来得出目标图像中像素在摆正之后的位置。

![img](https://pic2.zhimg.com/4602d32e87c3058cc6656424ac2bef45_b.png)<Fig. 相机标定，得出图像坐标（二维）跟世界坐标（三维）之间的对应关系>

![img](https://pic2.zhimg.com/23c95841aa4c6479112f4699786df755_b.png)<Fig. 通过相机标定，可以将图像坐标在不同视角之间变换>

不难理解的，该套算法稍加变化，就可以使用一张人脸图片得出多个角度的人脸图片，即既可以用来做人脸摆正，也可以生成侧脸图像 [10, 11]：

<Fig. 通过相机标定和3D模型模拟，生成其他视角的人脸图像>

这种做法虽然没有增加投入到训练算法中的信息，但大大增加了算法的识别率并降低了误识率(FAR, False Acceptance Rate):
![img](https://pic4.zhimg.com/f7d18f7be140ba56ae2646c55686cd2f_b.png)<Fig. 仅仅是通过现有图片生成多个角度(pose)的图片，然后投入训练算法，就能大大增加性能>

当然，生成不同角度的图像更原本就有同一个场景的连续变化视角的图像（视频）对人脸识别来说还是有一些不同的。更为接近自然场景中人脑的人脸识别任务的，是视频中人脸图像的识别。但是目前由于受限于人脸视频的稀缺性（搜集一个人脸的视频比搜集其图片要繁琐的多，同时视频中的特征标定也是一个严重的问题），深度学习/深度神经网络在视频人脸图像的研究还却如。目前在这个领域使用的一般是基于模型的传统算法[12-14]。视频中人脸的分辨率跟目前人脸图像数据及中的分辨率还有一定差距，同时视频图像的噪声更大，场景的复杂度好更高。因此视频中人脸识别跟静态图像中人类识别几乎是用的是完全不同的方法。在结合这两者，应用大量视频图像做人脸识别算法训练之前还得解决以上一系列的技术问题。
\--------

简单的说，外在特征(external features)指的是头发（颜色、发型）、脸部轮廓、脸颊等，内在特征(internal features）指的是眼睛、鼻子和嘴巴以及它们之间的内在关系 [1]。

![img](https://pic2.zhimg.com/50e303054a7a0e3aa9cab6f1b13c6c25_b.png)<Fig. 全脸(中)、外在特征(左下)与内在特征(右下)，源于[1]>

人类视野的分辨率从视野中央往外侧快速下降，因此需要不断的调整注视方向来获取高精度图像，也就是注意力点的变化。同时，人眼运动控制的相当部分是直接由脑干区域的神经核团支配的，也就是说，不受大脑皮层的控制，因此眼动在大部分情况下不进入意识层面，其运动控制表现出对注意力控制的被支配性。通过观测注视（眼动）的变化，可以获知人的注意力的重点 [2]，也就是信息获取的关键，眼动因此成为了人类意识的一个易于观测的外显参数 [3]。在我们人类发育的早期，观察人脸首先是注意外在特征多，然后逐步发展的更注意内在特征[4]。当然，这也可能与一岁以下的婴儿的视觉感知情况与更年长者有别有关，两个月以下的婴儿，他/她们的视觉处在一个快速发展的时期——由不清晰到清晰，同时色彩的感知也发生快速的变化[5-7]。

在成人的人脸识别过程总，内在特征与外在特征所扮演的角色各不相同，一般地，我们认为在识别陌生人脸的过程中，外部特征占有比较重要的作用（或者同等重要），当人脸变得熟悉时，外部特征在人脸识别中的重要性逐渐下降，而内部特种的重要性逐渐升高的主导地位 [8]。通过一些量化参数，我们可以大致的描述内在特征和外在特总在人脑的人脸识别任务中的地位[9, 10]：

<Fig. 人脑人脸识别任务中内部特征与外部特征各自的重要性>
当然地，一般认为，人脑人脸识别中，内在特征和外在特征是作为一个整体在大脑皮层的相关区域 (Fusiform Face Area, FFA; Occipital Face Area, OFA; Superior Temporal Sulcus, STS)处理，而不是分开的 [11]。

在计算机人脸识别领域，特别是在深度学习出现以前的使用模型的时代，算法研究一直将重心放在内在特征上 [12]，这跟计算机人脸识别的应用场景，以及投入到训练算法中的图像训练集有一定的关系。训练集里的同一个人经常有不同时期不同发型、妆容的图像，易于理解的，算法关注外在特征会降低算法的识别率并增加误识率，这对算法的性能是不利的 [13]。

<Fig. Active appearance model, AAM>

当然，也有一些人在外在特征方面做过一些尝试，[14] 中算法先使用训练集训练，得到外在特征块的集合Building Block Set，再使用特征块去匹配测试人脸图像，匹配度最高的Building Block提供了测试人脸特征，从而可以用来进行分类。

<Fig.使用外在特征进行人脸识别的样例>

该算法在当时能做到其他模型接近的精度，证明了外在特征进行人脸识别的可行性。但是如上文所说过的，外在特征天然的不稳定性，并不是做人脸识别的最优信息来源。由于大数据集和深度学习的普遍使用 [15]，外在特征在人脸识别算法中被研究人员不自觉的抛弃。新的人脸识别算法对遮挡、发型、妆容、光照这些外在影响的鲁棒性得到了很大的提高，人们对外在特征的关注似乎就到此为止了。